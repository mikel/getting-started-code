<% @post.tags.build if @post.tags.empty? %>
<% form_for(@post) do |post_form| %>
  <%= post_form.error_messages %>

  <div class="field">
    <%= post_form.label :name %><br />
    <%= post_form.text_field :name %>
  </div>
  <div class="field">
    <%= post_form.label :title %><br />
    <%= post_form.text_field :title %>
  </div>
  <div class="field">
    <%= post_form.label :content %><br />
    <%= post_form.text_area :content %>
  </div>
  <h2>Tags</h2>
  <% post_form.fields_for :tags do |tag_form| %>
    <div class="field">
      <%= tag_form.label :name, 'Tag:' %>
      <%= tag_form.text_field :name %>
    </div>
    <% unless tag_form.object.nil? || tag_form.object.new_record? %>
      <div class="field">
        <%= tag_form.label :_destroy, 'Remove:' %>
        <%= tag_form.check_box :_destroy %>
      </div>
    <% end %>
  <% end %>

  <div class="actions">
    <%= post_form.submit %>
  </div>
<% end %>
